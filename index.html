<script>
const API = "https://spin-api-production.up.railway.app"; // ganti URL API kamu

function spinStart() {
  const namaUser = document.getElementById("nama").value.trim();
  const kodeToken = document.getElementById("kode").value.trim();

  fetch(`${API}/cekDanPakaiToken`, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ nama: namaUser, kode: kodeToken })
  })
  .then(r => r.json())
  .then(res => {
    if (res.status === "OK") {
      document.getElementById("formPage").style.display = "none";
      document.getElementById("boxPage").style.display = "block";
      document.querySelectorAll(".box").forEach(b => {
        b.innerHTML = "🎁"; b.style.pointerEvents = "auto";
      });
    } else {
      document.getElementById("hasil").innerHTML = `<b>${res.msg}</b>`;
    }
  });
}

function simpanHasil(namaUser, kodeToken, hadiahUtama) {
  fetch(`${API}/simpanHasil`, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ nama: namaUser, kode: kodeToken, status: hadiahUtama })
  });
}

function getSisaHadiah() {
  return fetch(`${API}/getSisaHadiah`)
    .then(r => r.json());
}

function ambilHistori(user) {
  return fetch(`${API}/ambilHistoriGabungan/${encodeURIComponent(user)}`)
    .then(r => r.json());
}
</script>
